<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" prefix="og: http://ogp.me/ns#" xmlns:og="http://ogp.me/ns#"><!--<![endif]-->

<head>
          <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="author" content="tayu_tayu">
  
	
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@https://twitter.com/tayu_tayu">
        <meta name="twitter:creator" content="@https://twitter.com/tayu_tayu">
        <meta name="twitter:domain" content="https://Navarathri.github.io/blog">
	
        <meta property="og:site_name" content="たくあんは食べ物。">
        <meta property="og:title" content="たくあんは食べ物。">
        <meta property="og:url" content="https://Navarathri.github.io/blog/posts/2020-02-29-racket/">
        <meta property="og:description" content="tayu_tayu">
    
        <meta property="og:type" content="article" />
        <meta property="og:article:author" content="tayu_tayu" />
        <meta property="og:article:published_time" content="2020-02-29T09:00:00Z" />
    
        <meta name="generator" content="Hugo 0.75.1" />
  <title>Racket notes &middot; たくあんは食べ物。</title>
  <link rel="canonical" href="https://Navarathri.github.io/blog" />
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href=""
  />
  <link
    rel="stylesheet"
    type="text/css"
    href="https://Navarathri.github.io/blog/css/main.css"
  />
  <link
    href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300|Montserrat:700"
    rel="stylesheet"
    type="text/css"
  />
  <link
    href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"
    rel="stylesheet"
  />
  <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
</head>

<body>
<!--[if lt IE 7]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chrome/‎">install Google Chrome</a> to experience this site.</p><![endif]-->

    <header id="site-header">
        <div class="container">
            <a href="https://Navarathri.github.io/blog" alt="たくあんは食べ物。"><h1 class="blog-title heading">たくあんは食べ物。</h1></a>
            <p class="blog-description">tayu_tayu</p>
        </div>
    </header>
<main class="content" role="main">
	<div class="container">
		<article class="posts">
	<header class="post-header">
        <h3 class="p-post-title">Racket notes</h3>
    </header>

    <section class="post-content">
        <h2 id="basic">Basic</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#ff79c6">#lang </span>racket
(<span style="color:#ff79c6">provide</span> (<span style="color:#ff79c6">all-defined-out</span>))

<span style="color:#6272a4">;this is a comment</span>

(<span style="color:#ff79c6">define</span> s <span style="color:#f1fa8c">&#34;hello&#34;</span>)

(<span style="color:#ff79c6">define</span> x <span style="color:#bd93f9">3</span>)
(<span style="color:#ff79c6">define</span> y (<span style="color:#8be9fd;font-style:italic">+</span> x <span style="color:#bd93f9">2</span>))

(<span style="color:#ff79c6">define</span> cube1
  (<span style="color:#ff79c6">lambda</span> (x)
    (<span style="color:#8be9fd;font-style:italic">*</span> x (<span style="color:#8be9fd;font-style:italic">*</span> x x))))

(<span style="color:#ff79c6">define</span> cube2
  (<span style="color:#ff79c6">lambda</span> (x)
    (<span style="color:#8be9fd;font-style:italic">*</span> x x x)))

(<span style="color:#ff79c6">define</span> (cube3 x)
  (<span style="color:#8be9fd;font-style:italic">*</span> x x x))

(<span style="color:#ff79c6">define</span> (pow1 x y)
  (<span style="color:#ff79c6">if</span> (=y <span style="color:#bd93f9">0</span>)
      <span style="color:#bd93f9">1</span>
      (<span style="color:#8be9fd;font-style:italic">*</span> x (pow1 x (<span style="color:#8be9fd;font-style:italic">-</span> y <span style="color:#bd93f9">1</span>)))))

<span style="color:#6272a4">; currying</span>
(<span style="color:#ff79c6">define</span> pow2
  (<span style="color:#ff79c6">lambda</span> (x)
    (<span style="color:#ff79c6">lambda</span> (y)
      (pow1 x y))))

</code></pre></div><h3 id="list">List</h3>
<ul>
<li>Empty list: <code>null</code>
<ul>
<li><code>()</code> doesn&quot;t work for <code>null</code> but <code>'()</code> does</li>
</ul>
</li>
<li>build a list: <code>(list e1 ... en)</code></li>
<li>Constructor: <code>cons</code></li>
<li>Access head of list: <code>car</code></li>
<li>Access tail of list: <code>cdr</code></li>
<li>Check for empty: <code>null?</code></li>
</ul>
<h3 id="syntax">Syntax</h3>
<p>A term is either:</p>
<ul>
<li>An atom like <code>#t, #f, 34, &quot;hi&quot;, null, 4.0, x,...</code></li>
<li>A special form like <code>define, lambda, if</code></li>
<li>A sequence of terms in parentheses: <code>(t1 t2 t3)</code></li>
<li>Can use <code>[</code> anything you use <code>(</code></li>
</ul>
<p>Remember parentheses matters! For example:
<code>(e)</code> means call e with 0 argument.</p>
<h3 id="dynamic-typing">Dynamic typing</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define</span> lst (<span style="color:#8be9fd;font-style:italic">list</span> #t <span style="color:#f1fa8c">&#34;hi&#34;</span> <span style="color:#bd93f9">1</span> (<span style="color:#8be9fd;font-style:italic">list</span> <span style="color:#bd93f9">2</span> <span style="color:#bd93f9">3</span> <span style="color:#bd93f9">4</span>)))
</code></pre></div><h3 id="cond">Cond</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define</span> (sum3 xs)
  (<span style="color:#ff79c6">cond</span> [(<span style="color:#8be9fd;font-style:italic">null?</span> xs) <span style="color:#bd93f9">0</span>]
        [(<span style="color:#8be9fd;font-style:italic">number?</span> (<span style="color:#8be9fd;font-style:italic">car</span> xs)) (<span style="color:#8be9fd;font-style:italic">+</span> (<span style="color:#8be9fd;font-style:italic">car</span> xs) (sum3 (<span style="color:#8be9fd;font-style:italic">cdr</span> xs)))]
        [#t <span style="color:#bd93f9">0</span>]))
</code></pre></div><h3 id="what-is-true">What is true?</h3>
<p>Anything that is not <code>#f</code> is true <code>#t</code>.</p>
<h3 id="local-bindings">Local bindings</h3>
<h4 id="letletletrec">let/let*/letrec</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">let</span> ([x1 e1]
      [x2 e2]
      <span style="color:#ff79c6">...</span>
      [xn en])
  e)
</code></pre></div><p>Racket uses the environment <strong>before</strong> the let-expression to evaluate <code>e1 e2 ... en</code>, which means if <code>en</code> uses <code>x1</code>, <code>x2</code>, that would mean some outer variables of the same name. Instead, the expressions in <code>let*</code> are evaluated in the environment produced from the previous bindings (later ones shadow) .</p>
<p>The expressions in <code>letrec</code> are evaluated in the environment that includes all th bindings. It is needed for mutual recursion.</p>
<h3 id="set">set!</h3>
<p>Racket has assignment statements:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">set!</span> x e)
</code></pre></div><p>Once you have side-effects, sequences are useful:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">begin</span> e1 e2 e3)
</code></pre></div><h3 id="consmcons">cons/mcons</h3>
<p><code>cons</code> produces pairs or lists. (Actually lists are just extented pairs)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define</span> pr (<span style="color:#8be9fd;font-style:italic">cons</span> <span style="color:#bd93f9">1</span> (<span style="color:#8be9fd;font-style:italic">cons</span> #t <span style="color:#f1fa8c">&#34;hi&#34;</span>))) <span style="color:#6272a4">; is a pair</span>
(<span style="color:#ff79c6">define</span> lst (<span style="color:#8be9fd;font-style:italic">cons</span> <span style="color:#bd93f9">1</span> (<span style="color:#8be9fd;font-style:italic">cons</span> #t (<span style="color:#8be9fd;font-style:italic">cons</span> <span style="color:#f1fa8c">&#34;hi&#34;</span> <span style="color:#8be9fd;font-style:italic">null</span>)))) <span style="color:#6272a4">; is a list</span>
</code></pre></div><p><code>mcons</code> is another way to make pairs which allows you to change the value inside piars:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define</span> mpr (<span style="color:#8be9fd;font-style:italic">mcons</span> <span style="color:#bd93f9">1</span> (<span style="color:#8be9fd;font-style:italic">mcons</span> #t <span style="color:#f1fa8c">&#34;hi&#34;</span>)))
(<span style="color:#8be9fd;font-style:italic">mcar</span> mpr) <span style="color:#6272a4">; 1</span>
(<span style="color:#8be9fd;font-style:italic">mcdr</span> mpr) <span style="color:#6272a4">; (mcons (#t &#34;hi&#34;))</span>
(<span style="color:#8be9fd;font-style:italic">set-mcdr!</span> mpr <span style="color:#bd93f9">47</span>) <span style="color:#6272a4">; mpr becomes (mcons 1 47)</span>
</code></pre></div><p>Related form:</p>
<ul>
<li><code>mcons</code></li>
<li><code>mcar</code></li>
<li><code>mcdr</code></li>
<li><code>mpair?</code></li>
<li><code>set-mcar!</code></li>
<li><code>set-mcdr!</code></li>
</ul>
<h2 id="delayed-evaluation-and-thunk">Delayed Evaluation and Thunk</h2>
<p>In most programming languages, given <code>e1 e2 ... en</code>, the function arguments <code>e2, ..., en</code> are evaluated once before the function body is executed.
So if we define a function like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#ff79c6">define</span> (my-if-bad x y z) (<span style="color:#ff79c6">if</span> x y z))

(<span style="color:#ff79c6">define</span> (factorial-wrong x)
  (my-if-bad (<span style="color:#8be9fd;font-style:italic">=</span> x <span style="color:#bd93f9">0</span>)
             <span style="color:#bd93f9">1</span>
             (<span style="color:#8be9fd;font-style:italic">*</span> x (factorial-wrong (<span style="color:#8be9fd;font-style:italic">-</span> x <span style="color:#bd93f9">1</span>)))))
</code></pre></div><p>if we use <code>if</code> instead of <code>my-if-bad</code>, <code>factorial-wrong</code> acts just like we want. But with <code>my-if-bad</code>, the function never stops because the two branches evaluate at the same time.</p>
<p>Thanks to lambda, we can delay the evaluation, using the fact that function bodies are not evaluated until the function gets called.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rkt" data-lang="rkt">(<span style="color:#ff79c6">define</span> (my-if x y z) (<span style="color:#ff79c6">if</span> x (y) (z)))

(<span style="color:#ff79c6">define</span> (factorial x)
  (my-if (<span style="color:#8be9fd;font-style:italic">=</span> x <span style="color:#bd93f9">0</span>)
         (<span style="color:#ff79c6">lambda</span> () <span style="color:#bd93f9">1</span>)
         (<span style="color:#ff79c6">lambda</span> () (<span style="color:#8be9fd;font-style:italic">*</span> x (factorial (<span style="color:#8be9fd;font-style:italic">-</span> x <span style="color:#bd93f9">1</span>))))))
</code></pre></div><p>The general idiom of using a zero-argument function to delay evaluation is also called a <strong>thunk</strong> (or, thunk the argument).</p>
<p>By the way,</p>
<h2 id="lazy-evaluationcall-by-needpromises">Lazy-evaluation/Call-by-need/Promises</h2>
<h2 id="streams">Streams</h2>
<p>A stream is an infinite sequence of values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket"><span style="color:#ff79c6">#lang </span>racket
<span style="color:#6272a4">; 1 1 1 1 ...</span>
(<span style="color:#ff79c6">define</span> ones (<span style="color:#ff79c6">lambda</span> () (<span style="color:#8be9fd;font-style:italic">cons</span> <span style="color:#bd93f9">1</span> ones)))

<span style="color:#6272a4">; 1 2 3 4 ...</span>
(<span style="color:#ff79c6">define</span> nats
  (<span style="color:#ff79c6">letrec</span> ([f (<span style="color:#ff79c6">lambda</span> (x) (<span style="color:#8be9fd;font-style:italic">cons</span> x (<span style="color:#ff79c6">lambda</span> () (f (<span style="color:#8be9fd;font-style:italic">+</span> x <span style="color:#bd93f9">1</span>)))))])
     (<span style="color:#ff79c6">lambda</span> () (f <span style="color:#bd93f9">1</span>))))

<span style="color:#6272a4">; 2 4 6 8 ...</span>
(<span style="color:#ff79c6">define</span> power-of-two
  (<span style="color:#ff79c6">letrec</span> ([f (<span style="color:#ff79c6">lambda</span> (x) (<span style="color:#8be9fd;font-style:italic">cons</span> x (<span style="color:#ff79c6">lambda</span> () (f (<span style="color:#8be9fd;font-style:italic">*</span> x <span style="color:#bd93f9">2</span>)))))])
    (<span style="color:#ff79c6">lambda</span> () (f <span style="color:#bd93f9">2</span>))))

<span style="color:#6272a4">; higher-order maker</span>
(<span style="color:#ff79c6">define</span> (stream-maker fn arg)
  (<span style="color:#ff79c6">letrec</span> ([f (<span style="color:#ff79c6">lambda</span> (x) (<span style="color:#8be9fd;font-style:italic">cons</span> x (<span style="color:#ff79c6">lambda</span> () (f (fn x arg)))))])
    (<span style="color:#ff79c6">lambda</span> () (f arg))))
</code></pre></div><h2 id="memoization-not-memorization">Memoization (Not Memorization)</h2>
<p>Memoization is another idiom related to lazy evaluation that does not actually use thunks. To implement memoization we do use mutation: Whenever the function is called with an argument we have not seen before, we compute the answer and then add the result to the table.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define</span> fibonacci
  (<span style="color:#ff79c6">letrec</span>([memo <span style="color:#8be9fd;font-style:italic">null</span>]
          [f (<span style="color:#ff79c6">lambda</span> (x)
               (<span style="color:#ff79c6">let</span> ([ans (<span style="color:#8be9fd;font-style:italic">assoc</span> x memo)])
                 (<span style="color:#ff79c6">if</span> ans
                     (<span style="color:#8be9fd;font-style:italic">cdr</span> ans)
                     (<span style="color:#ff79c6">let</span> ([new-ans (<span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">or</span> (<span style="color:#8be9fd;font-style:italic">=</span> x <span style="color:#bd93f9">1</span>) (<span style="color:#8be9fd;font-style:italic">=</span> x <span style="color:#bd93f9">2</span>))
                                        <span style="color:#bd93f9">1</span>
                                        (<span style="color:#8be9fd;font-style:italic">+</span> (f (<span style="color:#8be9fd;font-style:italic">-</span> x <span style="color:#bd93f9">1</span>))
                                           (f (<span style="color:#8be9fd;font-style:italic">-</span> x <span style="color:#bd93f9">2</span>))))])
                       (<span style="color:#ff79c6">begin</span>
                         (<span style="color:#ff79c6">set!</span> memo (<span style="color:#8be9fd;font-style:italic">cons</span> (<span style="color:#8be9fd;font-style:italic">cons</span> x new-ans) memo))
                         new-ans)))))])
    f))
</code></pre></div><h2 id="macros">Macros</h2>
<p>Think about these things about macros and how Racket handles them better than other macro systems(notably C/C++)</p>
<ul>
<li>Tokenization</li>
<li>Parenthesization</li>
<li>Scope</li>
</ul>
<h3 id="syntax-1">Syntax</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">define-syntax</span> myif
  (<span style="color:#ff79c6">syntax-rules</span> (then <span style="color:#ff79c6">else</span>)
    [(my-if e1 then e2 <span style="color:#ff79c6">else</span> e3)
     (<span style="color:#ff79c6">if</span> e1 e2 e3)]))

(<span style="color:#ff79c6">define-syntax</span> my-delay
  (<span style="color:#ff79c6">syntax-rules</span> ()
    [(my-delay e)
     (<span style="color:#8be9fd;font-style:italic">mcons</span> #f (<span style="color:#ff79c6">lambda</span> () e))]))

</code></pre></div><h3 id="hygiene">Hygiene</h3>
<h2 id="recursive-datatypes-via-racketss-struct">Recursive Datatypes Via Rackets&rsquo;s <code>struct</code></h2>
<p><a href="https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29">https://docs.racket-lang.org/reference/define-struct.html?q=struct#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._struct%29%29</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-racket" data-lang="racket">(<span style="color:#ff79c6">struct</span> foo (bar baz quux) <span style="color:#8be9fd;font-style:italic">#:transparent</span>
</code></pre></div>
    </section>

    <hr>

    <footer class="post-footer">
        <section class="f-1">
            
            <section class="author">
                <p>Words by tayu_tayu</p>
            </section>
            
            
            <p class="f-post-time"><time datetime="2020-02-29T09:00:00Z">February 29, 2020</time></p>
        </section>
                        
        <section class="f-2">
            <section class="share">
                <span>Share:
                <a class="icon-twitter" href="http://twitter.com/share?text=Racket%20notes&url=https%3a%2f%2fNavarathri.github.io%2fblog%2fposts%2f2020-02-29-racket%2f"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fNavarathri.github.io%2fblog%2fposts%2f2020-02-29-racket%2f"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2fNavarathri.github.io%2fblog%2fposts%2f2020-02-29-racket%2f"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="fa fa-google-plus"></i>
                </a>
                </span>
            </section>

            
            	<span class="f-post-tags"><i class="fa fa-tag"></i>
            	racket
            	</span>
            
        </section>
                        
    </footer>
</article>
	</div>
</main>
<footer id="site-footer">
  <div class="container">
    
    <a href="https://www.twitter.com/tayu_tayu" title="Twitter" target="_blank"><span class="tooltip"><i class="fa fa-twitter"></i></span></a>
    
    
    <a href="https://Navarathri.github.io/blog/index.xml" title="Get the RSS feed"><span class="tooltip"><i class="fa fa-rss"></i></span></a>
    <section>&copy; <a href="https://twitter.com/tayu_tayu" title="Twitter@tayu_tayu" target="_blank"><span class="tooltip"></span>tayu_tayu</span></a> 2020 | All rights reserved</section>
  </div>
</footer>

<script type="text/javascript" src="https://Navarathri.github.io/blog/js/fittext.js"></script>
<script type="text/javascript">
  $(".heading").fitText();
</script>




</body>
</html>